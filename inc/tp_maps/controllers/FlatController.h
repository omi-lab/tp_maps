#ifndef tp_maps_FlatController_h
#define tp_maps_FlatController_h

#include "tp_maps/Controller.h"

namespace tp_maps
{

//##################################################################################################
class TP_MAPS_SHARED_EXPORT FlatController : public Controller
{
public:
  //################################################################################################
  FlatController(Map* map);

  //################################################################################################
  glm::vec3 focalPoint()const;

  //################################################################################################
  void setFocalPoint(const glm::vec3& focalPoint);

  //################################################################################################
  float distance()const;

  //################################################################################################
  void setDistance(float distance);

  //################################################################################################
  bool allowRotation()const;

  //################################################################################################
  void setAllowRotation(bool allowRotation);

  //################################################################################################
  bool variableViewAngle()const;

  //################################################################################################
  void setVariableViewAngle(bool variableViewAngle);

  //################################################################################################
  bool allowTranslation()const;

  //################################################################################################
  void setAllowTranslation(bool allowTranslation);

  //################################################################################################
  bool allowZoom()const;

  //################################################################################################
  void setAllowZoom(bool allowZoom);

  //################################################################################################
  //! Rotation in degrees
  float rotationAngle()const;

  //################################################################################################
  void setRotationAngle(float rotationAngle);

  //##################################################################################################
  float rotationFactor()const;

  //##################################################################################################
  void setRotationFactor(float rotationFactor);

  //################################################################################################
  nlohmann::json saveState()const override;

  //################################################################################################
  void loadState(const nlohmann::json& j)override;

protected:
  //################################################################################################
  ~FlatController()override;

  //################################################################################################
   void mapResized(int w, int h)override;

  //################################################################################################
  void updateMatrices()override;

  //################################################################################################
  bool mouseEvent(const MouseEvent& event)override;

  //################################################################################################
  virtual void translate(float dx, float dy, double msSincePrevious);

  //################################################################################################
  virtual void translateInteractionFinished();

  //################################################################################################
  virtual void translateInteractionStarted();

private:
  struct Private;
  Private* d;
  friend struct Private;
};

}

#endif
